class Parameter
{
    protected $key;
    protected $value;

    public function __construct($key, $value = null)
    {
        if (empty($key)) {
            throw new \InvalidArgumentException('no key given');
        }
        $this->key = $key;
        $this->value = $value;
    }

    public function getId()
    {
        return $this->key;
    }

    public function getValue()
    {
        return $this->value;
    }

    public function __toString()
    {
        $value = $this->getValue();
        if (is_null($value)) {
            $paramStr = $this->key;
        } elseif (is_bool($value)) {
            $paramStr = $this->key . '=' . ($value ? 'true' : 'false');
        } else {
            $paramStr = $this->key . '=' . urlencode((string)$value);
        }

        return $paramStr;
    }
}

class MultiParameter extends Parameter
{
    public function getId()
    {
        return $this->__toString();
    }
}

class Resource
{
    protected $client;
    protected $uri;

    public function __construct($uri, Client $client)
    {
        $this->uri = $uri;
        $this->client = $client;
    }
}



class RootResource extends Resource
{

{{#each resources}}
{{#unless uriParameters}}
    public ${{camelCase relativeUri}};
{{/unless}}
{{/each}}


    public function __construct($uri, $client)
    {
        parent::__construct($uri, $client);

        {{#each resources}}
        {{#unless uriParameters}}
        $this->{{camelCase relativeUri}} = new {{pascalCase relativeUri}}($this->uri . {{{stringify relativeUri}}}, $client);
        {{/unless}}
        {{/each}}
    }

    {{#each resources}}
    {{#if uriParameters}}
    public function {{camelCase relativeUri}}({{#each uriParameters}}${{displayName}}{{#if default}} = {{{stringify default}}}{{/if}}{{#unless @last}}, {{/unless}}{{/each}})
    {
        {{#each uriParameters}}
        {{#if default}}
        if (is_null(${{displayName}})) {
            ${{displayName}} = {{{stringify default}}};
        }
        {{/if}}
        {{/each}}
        $uri = $this->uri . template({{{stringify relativeUri}}}, [{{#each uriParameters}}${{displayName}}{{#unless @last}}, {{/unless}}{{/each}}]);

        return new {{pascalCase relativeUri}}($uri, $this->client);
    }
    {{/if}}
    {{/each}}

}



{{#each resources}}
{{> resource}}
{{/each}}


class CustomResource extends Resource
{
    {{#each supportedMethods}}
    public function {{camelCase this}}($body = null, $options = [])
    {
        return $this->client->request($this->uri, {{{stringify (upperCase this)}}}, $body, $options);
    }
{{/each}}
}
